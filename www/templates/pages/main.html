<html>
    <head>
        <link rel="stylesheet" href="/assets/css/chart.css">

 
       

    </head>

    <body>
        {{#winfo}}

        <div class="row">
            <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-info elevation-1"><i class="fa fa-file-invoice "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Замовлень</span>
                        <span class="info-box-number">
                            {{biorders}}

                        </span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>

            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa  fa-pallet"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Товарiв на  складi</span>
                        <span class="info-box-number">
                            На суму  {{biitemscnt}}


                        </span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>

          <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-money-bill "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Готiвка</span>
                        <span class="info-box-number">
                            На суму  {{binal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
             <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-credit-card "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Безготiвка</span>
                        <span class="info-box-number">
                            На суму  {{bibeznal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
          
            
            
            <div class="col-auto   ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-out-alt"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Кред. борг</span>
                        <span class="info-box-number">
                            На суму  {{bicredit}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-in-alt "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Деб. борг</span>
                        <span class="info-box-number">
                            На суму  {{bidebet}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>

        </div>
        {{/winfo}}

        {{#wgraph}}

        <div class="row">

            <div   class="col-12  col-lg-4   ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="paystructure"></canvas>
                    </div>
                </div>  
            </div>

            <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="paycompare"></canvas>
                    </div>
                </div>    
            </div>
            <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="sellstat"></canvas>
                    </div>
                </div>    
            </div>
        </div>     
        {{/wgraph}}    

        <div class="row">  


            {{#wsdate}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Просроченi товари</h4>
                        <br><a zippy="sdcsv">Експорт в  Excel</a>
                        <small>Товари для котрих закiнчився срок придатностi</small>
                        <table class="table   table-sm">
                            <tr>

                                <th>Склад</th>
                                <th>Товар</th>
                                <th>Серiя</th>
                                <th>Придатний до</th>
                                <th class="text-right">Кiл.</th>
                            </tr>
                            <tr zippy="sdlist" >
                                <td zippy="wsd_storename"></td>
                                <td zippy="wsd_itemname"></td>
                                <td zippy="wsd_snumber"></td>
                                <td><span zippy="wsd_edate"></span></td>
                                <td zippy="wsd_qty" class="text-right"></td>
                            </tr>
                        </table>
                        <div zippy="sdpag" ></div>               

                    </div>
                </div>
            </div>
            {{/wsdate}}
            {{#wminqty}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Мiнiмальна кiлькiсть </h4>
                        <small>Товари для якмх задана мiнiмальна  кiлькiсть на складi  та актуальна кiлькiсть менше заданоi</small>
                        <br><a zippy="mqcsv">Експорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                  <th>Склад</th>
                           
                                <th>Товар</th>
                                <th>Код</th>

                                <th class="text-right">Факт</th>
                                <th class="text-right">Мин.</th>
                            </tr>
                            <tr zippy="mqlist">
                                <td zippy="wmq_storename"></td>
           
                                <td zippy="wmq_itemname"></td>
                                <td zippy="wmq_item_code"></td>
                                <td zippy="wmq_qty" class="text-right"></td>
                                <td zippy="wmq_minqty" class="text-right"></td>
                            </tr>
                        </table>             
                        <div zippy="mqpag"></div>        
                    </div>
                </div>
            </div>      
            {{/wminqty}}


            {{#wrdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Недавнi документи</h4>
                        <small>Документи з недавно змiненим статусом</small>
                        <br><a zippy="rdcsv">Експорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Статус</th>
                                <th class="text-right">Сума</th>
                                <th>Змiнив</th>
                                <th>Дата</th>
                                

                            </tr>
                            <tr zippy="rdoclist">
                               <td><a zippy="wrd_number"></a></td>
                                <td zippy="wrd_type"></td>
                                <td zippy="wrd_state"></td>
                                <td class="text-right" zippy="wrd_amount"></td>
                                <td zippy="wrd_user"></td>
                                <td zippy="wrd_date"></td>
                                
                            </tr>
                        </table>
                        <div zippy="wrpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wrdoc}}
               {{#wmdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Мої документи</h4>
                        <small>Документи, створені поточним користувачем</small>
                        <br><a zippy="mdcsv">Експорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Дата</th>
                                <th class="text-right">Сума</th>

                            </tr>
                            <tr zippy="mdoclist">
                                <td><a zippy="wmd_number"></a></td>
                                <td zippy="wmd_type"></td>
                                <td zippy="wmd_date"></td>
                                <td class="text-right" zippy="wmd_amount"></td>
                            </tr>
                        </table>
                        <div zippy="wmpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wmdoc}}

      
        </div>
            {{#isadmins}}
           <div class="row justify-content-center">
            
            <div class="col-12 pl-4"  >
               <small>  Версiя програми v{{curversion}}. Версiя БД v{{curversionbd}}  </small>
            </div>
        </div>
           {{/isadmins}}

     




        <script language="javascript" src="/assets/js/chart.js"></script>

        <script>
        
    var fontcolor='#000' ;
        {{#darkmode}}
            fontcolor='#fff' ;
        {{/darkmode}}              
        
//структура   расходов
var pieData = {
labels: {{{pbtitle}}},
        datasets: [
        {
        data: {{{pbdata}}},
                backgroundColor : {{{pbcolor}}},
        }
        ]
}


var pieOptions = {
maintainAspectRatio : false,
        responsive : true,
        title: {
        display: true,   fontColor: fontcolor,
                text: 'Структура видаткiв за  три мiсяцi',
                position: 'top'

        },
        legend: {
        display: true,
                position: 'right',
                labels: {
                boxWidth: 10,
                        fontColor: fontcolor,
                        padding:  5
                }
        },
        tooltips: {
        enabled: true
        },
}

//сравнение  доходоа  и расходов




var barData = {
labels: {{{pcmon}}},
        datasets: [
        {
        label: "Видаток",
                backgroundColor: "red",
                data: {{{pcout}}}
        }, {
        label: "Прибуток",
                backgroundColor: "green",
                data: {{{pcin}}}
        }
        ]
}


var barOptions = {
legend: {
display: true,
        position: 'right',  
        labels: {
                
                        fontColor: fontcolor 
                        
                }
         },
        title: {
        display: true,   fontColor: fontcolor,
                text: 'Прибутки та  видатки'
        }
        
, 
       scales: {
        xAxes: [{
             ticks: { 
                   fontColor: fontcolor 
             } 
        }],
                yAxes: [{    ticks: { 
                   fontColor: fontcolor 
             } 
                }]
        }                  
}


var sellData = {
labels  : {{{tsmon}}},
        datasets: [
        {
        label               : 'Товари',
                backgroundColor         : 'rgba(60,141,188,0.8)',
                borderColor         : 'rgba(60,141,188,0.8)',
                fill          : false,
                data                :  {{{tstov}}}
        },
        {
        label               : 'Послуги',
                backgroundColor         : 'rgba(210, 100, 100, 1)',
                borderColor         : 'rgba(210, 100, 100, 1)',
                fill          : false,
                data                :  {{{tsser}}}
        },
        ]
}






var sellOptions = {
title: {
display: true,   fontColor: fontcolor,
        text: 'Реалiзацiя'
},

legend: {
   labels: {
                
                        fontColor: fontcolor 
                        
                }
      
        }, 

        scales: {
        xAxes: [{     ticks: { 
                   fontColor: fontcolor 
             },
        gridLines : {
        display : false,
        }
        }],
                yAxes: [{    ticks: { 
                   fontColor: fontcolor 
             },
                gridLines : {
                display : false,
                }
                }]
        }
}

window.onload = function() {


new Chart(document.querySelector('#paystructure'), {
type: 'pie',
        data: pieData,
        options: pieOptions
})

        new Chart(document.querySelector('#paycompare'), {
        type: 'bar',
                data: barData,
                options: barOptions
        })

        new Chart(document.querySelector('#sellstat'), {
        type: 'line',
                data: sellData,
                options: sellOptions
        })


};
 
    /*
   
   function cl(){
      var input = document.querySelector('#tf')

    var data = new FormData()
    data.append('file', input.files[0])
  

             
     fetch('http://local.next/api/app/uploadfile?DBGSESSID=447335844422600002;d=1,p=0,c=1', { 
        method: 'post', 
        headers: new Headers({
            'Authorization': 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiMiIsImlhdCI6MTY1NTgwOTM4NSwiZXhwIjoxNjU1ODk1Nzg1fQ.GMrtcnK60IZ2q-P9Oh0SxUkd01EXGlH9oEM37-1Swes' 
            
        }), 
        body: data
    });
         
   }
*/
        </script>
  
    </body>
</html>
