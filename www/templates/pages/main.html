<html>
    <head>
        <link rel="stylesheet" href="/assets/css/chart.css">

 
       

    </head>

    <body>
        {{#winfo}}

        <div class="row  " style="justify-content: space-between">
             <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-info elevation-1"><i class="fa fa-file-invoice "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Заказов</span>
                        <span class="info-box-number">
                            {{biorders}}

                        </span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>

            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa  fa-pallet"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Товаров на складе</span>
                        <span class="info-box-number">
                            На сумму  {{biitemscnt}}


                        </span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>

          <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-money-bill "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Наличные</span>
                        <span class="info-box-number">
                            На сумму  {{binal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
             <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-credit-card "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Безнал</span>
                        <span class="info-box-number">
                            На сумму  {{bibeznal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
          
            
            
            <div class="col-auto   ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-out-alt"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Кред. долг</span>
                        <span class="info-box-number">
                            На сумму  {{bicredit}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-in-alt "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Деб. долг</span>
                        <span class="info-box-number">
                            На сумму  {{bidebet}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>

        </div>
        {{/winfo}}

        {{#wgraph}}

        <div class="row">
            <div   class="col-12  col-lg-4   ">
                <div   class="card ">


                        <div style="width:100%" id="paystructure"></div>
                    </div>

            </div>
 

  
 
           <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    
                        <div style="width:100%" id="paycompare"></div>
                  
                </div>    
            </div>
         
          <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    

                        <div style="width:100%" id="sellstat"></div>
                    
                </div>    
            </div>
        </div>     
        {{/wgraph}}    

        <div class="row">  


            {{#wsdate}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Просроченные товары</h4>
                        <br><a zippy="sdcsv">Экспорт в Excel</a>
                        <small>Товары для которых закончился срок годности</small>
                        <table class="table   table-sm">
                            <tr>

                                <th>Склад</th>
                                <th>Товар</th>
                                <th>Серия</th>
                                <th>Годен до</th>
                                <th class="text-right">Кол.</th>
                            </tr>
                            <tr zippy="sdlist" >
                                <td zippy="wsd_storename"></td>
                                <td zippy="wsd_itemname"></td>
                                <td zippy="wsd_snumber"></td>
                                <td><span zippy="wsd_edate"></span></td>
                                <td zippy="wsd_qty" class="text-right"></td>
                            </tr>
                        </table>
                        <div zippy="sdpag" ></div>               

                    </div>
                </div>
            </div>
            {{/wsdate}}
            {{#wminqty}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Минимальное количество </h4>
                        <small>Товары для которых задано минимальное количество на складе и актуальное количество меньше заданого</small>
                        <br><a zippy="mqcsv">Экспорт в Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                  <th>Склад</th>
                           
                                <th>Товар</th>
                                <th>Код</th>

                                <th class="text-right">Факт</th>
                                <th class="text-right">Мин.</th>
                            </tr>
                            <tr zippy="mqlist">
                                <td zippy="wmq_storename"></td>
           
                                <td zippy="wmq_itemname"></td>
                                <td zippy="wmq_item_code"></td>
                                <td zippy="wmq_qty" class="text-right"></td>
                                <td zippy="wmq_minqty" class="text-right"></td>
                            </tr>
                        </table>             
                        <div zippy="mqpag"></div>        
                    </div>
                </div>
            </div>      
            {{/wminqty}}


            {{#wrdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Недавние документы</h4>
                        <small>Документы с недавно измененным статусом</small>
                        <br><a zippy="rdcsv">Экспорт в Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Статус</th>
                                <th class="text-right">Сумма</th>
                                <th>Сменил</th>
                                <th>Дата</th>
                                

                            </tr>
                            <tr zippy="rdoclist">
                               <td><a zippy="wrd_number"></a></td>
                                <td zippy="wrd_type"></td>
                                <td zippy="wrd_state"></td>
                                <td class="text-right" zippy="wrd_amount"></td>
                                <td zippy="wrd_user"></td>
                                <td zippy="wrd_date"></td>
                                
                            </tr>
                        </table>
                        <div zippy="wrpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wrdoc}}
               {{#wmdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Мои документы</h4>
                        <small>Документы, созданные текущим пользователем</small>
                        <br><a zippy="mdcsv">Экспорт в Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Дата</th>
                                <th class="text-right">Сумма</th>

                            </tr>
                            <tr zippy="mdoclist">
                                <td><a zippy="wmd_number"></a></td>
                                <td zippy="wmd_type"></td>
                                <td zippy="wmd_date"></td>
                                <td class="text-right" zippy="wmd_amount"></td>
                            </tr>
                        </table>
                        <div zippy="wmpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wmdoc}}

      
        </div>
            {{#isadmins}}
           <div class="row justify-content-center">
            
            <div class="col-12 pl-4"  >
               <small>  Версия программы v{{curversion}}. Версия БД v{{curversionbd}}  </small>
            </div>
        </div>
           {{/isadmins}}

     



    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart'], 'language': 'ru'});
      google.charts.setOnLoadCallback(drawChart);

      
    var fontcolor='#000' ;
    var bgcolor='#fff' ;
        {{#darkmode}}
            fontcolor='#fff' ;
            bgcolor='#333' ;
        {{/darkmode}}            
      
      
      
      function drawChart() {

        //структура видатків
          
        var psdata = google.visualization.arrayToDataTable( 
        
          {{{ps}}}
        
        );

        
        
        
        var psoptions = {
          title: 'Структура расходов  за шесть месяцев]' ,
          sliceVisibilityThreshold: 0.03,         
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
          chartArea:{
               "left":10 , "right":60
          } ,
                  
          legendTextStyle:{
             "color":fontcolor 
          } ,
                  
        };

  
       //старвнение
        var pschart = new google.visualization.PieChart(document.getElementById('paystructure'));

        pschart.draw(psdata, psoptions);
        
        
  
     
      var pcdata = new google.visualization.DataTable();
      pcdata.addColumn('string', 'Месяц');
      pcdata.addColumn('number', 'Доходы');
      pcdata.addColumn('number', 'Расходы');

      pcdata.addRows(
          {{{pc}}}
      );

      var pcoptions = {
        title: 'Доходы и расходы',
        legend:{
            position:"bottom"
        }  ,
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
      
                  
          legendTextStyle:{
             "color":fontcolor 
          } , 
          
          hAxis:{
           
              textStyle: {
                color: fontcolor
              }
            } ,
          vAxis:{
              gridlines:null,
              textStyle: {
                color: fontcolor
              }
            } ,                 
      };
      
      var pcchart = new google.visualization.ColumnChart(document.getElementById('paycompare'));
      pcchart.draw(pcdata, pcoptions);
      
     
       //продажи
          
         
        var tsdata = new google.visualization.DataTable();
      tsdata.addColumn('string', 'Месяц');
      tsdata.addColumn('number', 'Услуги');
      tsdata.addColumn('number', 'Товары');

      tsdata.addRows( 
       {{{ts}}}
     )
        
        
        
        var tsoptions = {
          title: 'Реализация',
          curveType: 'function',
          legend: { position: 'bottom' } ,
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
      
          legendTextStyle:{
             "color":fontcolor 
          } , 
          
          hAxis:{
           
              textStyle: {
                color: fontcolor
              }
            } ,
          vAxis:{
              gridlines:null,
              textStyle: {
                color: fontcolor
              }
            } ,
            
                   
        };

        var tschart = new google.visualization.LineChart(document.getElementById('sellstat'));

        tschart.draw(tsdata, tsoptions);       
        
        
        
        
        
        
        
        
      }
    </script
  
    </body>
</html>
