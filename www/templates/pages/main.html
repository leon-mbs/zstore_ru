<html>
    <head>
      <title>Дашборд</title>
      
       
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    </head>

    <body>
        {{#dashboard}}
  

        <div class="row  "  >
            <div class="col-6 col-sm-4 col-lg-2 ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{biorders}}</h4>
                    <p>Заказов</p>
                  </div>
             </div>
            </div>
           <div class="col-6 col-sm-4 col-lg-2  ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{biitemscnt}}</h4>
                    <p>ТМЦ   (на сумму)</p>
                  </div>
             </div>
            </div>
        <div class="col-6 col-sm-4 col-lg-2  ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{binal}}</h4>
                    <p>Наличные</p>
                  </div>
             </div>
            </div>
           <div class="col-6 col-sm-4 col-lg-2  ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{bibeznal}}</h4>
                    <p>Безнал</p>
                  </div>
             </div>
            </div>
           <div class="col-6 col-sm-4 col-lg-2  ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{bicredit}}</h4>
                    <p>Кред. долг</p>
                  </div>
             </div>
            </div>

         <div class="col-6 col-sm-4 col-lg-2  ">
               <div class="small-box bg-info">
                  <div class="inner">
                    <h4>{{bidebet}}</h4>
                    <p>Деб. долг</p>
                  </div>
             </div>
            </div>

      

        </div>
   

        <div class="row">

            <div   class="col-12  col-lg-4   ">
                <div    class="card pb-3">


                        <div style="width:100%" id="paystructure"></div>
                    </div>

            </div>
 

  
 
           <div   class="col-12  col-lg-4 ">
                <div    class="card pb-3">
                    
                        <div style="width:100%" id="paycompare"></div>
                  
                </div>    
            </div>
         
          <div   class="col-12  col-lg-4 ">
                <div    class="card pb-3">
                   

                        <div style="width:100%;" id="sellstat"></div>
                     
                </div>    
            </div>
        </div>     
     
        {{/dashboard}}    

        <div class="row">  

           <div   class="col-12 col-lg-6 ">
 
         


                <div   class="card ">
                    <div   class="card-body">
                        <h4>Последние документы</h4>
                        <small>Недавно измененные документы</small>
                        <br><a zippy="rdcsv">Экспорт у Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Статус</th>
                                <th class="text-right">Сумма</th>
                                <th>Изменил</th>
                                <th>Изменено</th>
                                

                            </tr>
                            <tr zippy="rdoclist">
                               <td><a zippy="wrd_number"></a></td>
                                <td zippy="wrd_type"></td>
                                <td zippy="wrd_state"></td>
                                <td class="text-right" zippy="wrd_amount"></td>
                                <td zippy="wrd_user"></td>
                                <td zippy="wrd_date"></td>
                                
                            </tr>
                        </table>
                        <div zippy="wrpag"></div>    
                    </div>
                </div>
             </div> 
           <div   class="col-12 col-lg-6 ">
           
                <div   class="card ">
                    <div   class="card-body">
                        <h4>Мои документы</h4>
                        <small>Документы, созданные текущим пользоваталем</small>
                        <br><a zippy="mdcsv">Экспорт в Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Дата</th>
                                <th class="text-right">Сумма</th>

                            </tr>
                            <tr zippy="mdoclist">
                                <td><a zippy="wmd_number"></a></td>
                                <td zippy="wmd_type"></td>
                                <td zippy="wmd_date"></td>
                                <td class="text-right" zippy="wmd_amount"></td>
                            </tr>
                        </table>
                        <div zippy="wmpag"></div>    
                    </div>
                </div>

            
            </div>   
            
  {{#dashboard}}            
               
             <div   class="col-12 col-lg-6 ">
    
         
                <div   class="card ">
                    <div   class="card-body">
                        <h4>Критическое  количество </h4>
                        <small>Товары для которых задано минимальное  количество и наличие меньше минимального</small>
                        <br><a zippy="mqcsv">Экспорт у Excel</a>
                        <table class="table   table-sm">
                            <tr>
                              
                           
                                <th>Товар</th>
                                <th>Код</th>
                                <th>Поставил</th>

                                <th class="text-right">Факт</th>
                                <th class="text-right">Мин.</th>
                            </tr>
                            <tr zippy="mqlist">
                               
                                <td zippy="wmq_itemname"></td>
                                <td zippy="wmq_item_code"></td>
                                <td zippy="wmq_cust"></td>
                                <td zippy="wmq_qty" class="text-right"></td>
                                <td zippy="wmq_minqty" class="text-right"></td>
                            </tr>
                        </table>             
                        <div zippy="mqpag"></div>        
                    </div>
                </div>
           </div>    
            <div   class="col-12 col-lg-6 ">
                   
            {{#usesnumberdate}}
                   <div   class="card ">
                    <div   class="card-body">
                        <h4>Просроченi товары</h4>
                        <small>Товары для которых закончился  срок  годности</small>
                        <br><a zippy="sdcsv">Экспорт в Excel</a>
                        <table class="table   table-sm">
                            <tr>

                                <th>Склад</th>
                                <th>Товар</th>
                                <th>Серия</th>
                                <th>Годен до</th>
                                <th class="text-right">Кол.</th>
                            </tr>
                            <tr zippy="sdlist" >
                                <td zippy="wsd_storename"></td>
                                <td zippy="wsd_itemname"></td>
                                <td zippy="wsd_snumber"></td>
                                <td><span zippy="wsd_edate"></span></td>
                                <td zippy="wsd_qty" class="text-right"></td>
                            </tr>
                        </table>
                        <div zippy="sdpag" ></div>               

                    </div>
                </div>
         
            {{/usesnumberdate}}
            
                     
      
        </div>
        
   {{/dashboard}}         
      </div>
   
 
 
     <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart'], 'language': 'ru'});
      google.charts.setOnLoadCallback(drawChart);

      
    var fontcolor='#000' ;
    var bgcolor='#fff' ;
        {{#darkmode}}
            fontcolor='#fff' ;
            bgcolor='#333' ;
        {{/darkmode}}            
      
      
      
      function drawChart() {

        //структура расходов
          
        var psdata = google.visualization.arrayToDataTable( 
        
          {{{ps}}}
        
        );

        
        
        
        var psoptions = {
          title: 'Структура расходов за год' ,
          sliceVisibilityThreshold: 0.025,         
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                      
          chartArea:{
              "left":10 , "right":60
          } ,
                  
          legendTextStyle:{
             "color":fontcolor 
          } ,
                  
        };

  
       //срвнение
        var pschart = new google.visualization.PieChart(document.getElementById('paystructure'));

        pschart.draw(psdata, psoptions);
        
        
  
     
      var pcdata = new google.visualization.DataTable();
      pcdata.addColumn('string', 'Месяц');
      pcdata.addColumn('number', 'Доходы');
      pcdata.addColumn('number', 'Расходы');

      pcdata.addRows(
          {{{pc}}}
      );

      var pcoptions = {
        title: 'Доходы и расходы',
        legend:{
            position:"bottom"
        }  ,
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
            chartArea : {
                     
          },               
      
                  
          legendTextStyle:{
             "color":fontcolor 
          } , 
          
          hAxis:{
           
              textStyle: {
                color: fontcolor
              }
            } ,
          vAxis:{
              gridlines:null,
              textStyle: {
                color: fontcolor
              }
            } ,                 
      };
      
      var pcchart = new google.visualization.ColumnChart(document.getElementById('paycompare'));
      pcchart.draw(pcdata, pcoptions);
      
     
       //продажи
          
         
        var tsdata = new google.visualization.DataTable();
      tsdata.addColumn('string', 'Месяц');
      tsdata.addColumn('number', 'Услуги');
      tsdata.addColumn('number', 'Товары');

      tsdata.addRows( 
       {{{ts}}}
     )
        
        
        
        var tsoptions = {
          title: 'Реализация',
          curveType: 'function',
          legend: { position: 'bottom' } ,
          chartArea : {
                      
          },
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
      
          legendTextStyle:{
             "color":fontcolor 
          } , 
          
          hAxis:{
           
              textStyle: {
                color: fontcolor
              }
            } ,
          vAxis:{
              gridlines:null,
              textStyle: {
                color: fontcolor
              }
            } ,
            
                   
        };

        var tschart = new google.visualization.LineChart(document.getElementById('sellstat'));

        tschart.draw(tsdata, tsoptions);       
        
        
        
        
        
        
        
        
      }
    </script>
  
    </body>
</html>
