<html>
    <head>
          <title> Приходная накладня</title>
    </head>
   <body>


        <form zippy="docform" enctype="multipart/form-data">
            <h3> Приходная накладня </h3>
            <div class="row">
                <div class="col-12 col-md-3">
                    <div class="form-group">
                        <label for="document_number">Номер документа <small class="text-danger">*</small></label>
                        <input class="form-control" type="text" zippy="document_number"  required="on" >
                    </div>
                    <div class="form-group">
                        <label for="document_date"> Дата <small class="text-danger">*</small></label>
                        <input class="form-control" type="text" zippy="document_date"  required="on" >
                    </div>
                

                    <div class="form-group  ">
                        <label for="customer">Поставщик <small class="text-danger">*</small></label>
                          <div class="input-group  ">
                            <input placeholder="Начните  вводить..." class="form-control " zippy="customer"/>
                              <div class="input-group-append">
                                 <a title="Добавить нового" class="btn btn-success" zippy="addcust" >+</a>
                            </div>                    
                        </div>             
                        

                    </div>


                    <div class="form-group  ">
                        <label for="contract" data-label="contract">Договор</label>
                        <select class="form-control" zippy="contract">
                            <option value="0">Не выбрано</option>
                        </select>


                    </div>
                    <div class="form-group  ">
                        <label for="payreq">Реквизиты для оплаты </label>

                        <textarea class="form-control"   zippy="payreq"></textarea>

                    </div>
                </div>
                <div class="col-12 col-md-3">

                    <div class="form-group  ">
                        <label for="store">На склад</label>
                        <select class="form-control" zippy="store">
                            <option value="0">Не выбрано</option>
                        </select>
                    </div>
                  {{#storeemp}}
                     <div class="form-group  ">
                        <label for="storeemp">На сотрудника</label>
                        <select class="form-control  " zippy="storeemp">
                            <option value="0">Не выбрано</option>
                        </select>
                        <small> Маиериально-ответственное лицо</small>
                    </div> 
                      {{/storeemp}} 
                    <div class="form-group  ">
                        <label for="payment">КассаЮ счет</label>
                        <select class="form-control" zippy="payment">
                            <option value="0">Не выбрано</option>
                        </select>

                    </div>
                    <div class="form-group  ">
                        <label for="rate">Курс </label>
                        <input pattern="[0-9,\.]+" class="form-control qtyprice" type="text" zippy="rate">
                        <small for="rate">Проводки  по кассе  и  складу будут  выполнены в национальной валюте по  курсу</small>
                        
                    </div>                      
                    {{#useval}}

                    <div class="form-group  ">
                        <label for="val">Валюта</label>
                        <select class="form-control" zippy="val">
                            <option value="0">В нац. валюте</option>
                        </select>

                    </div>
                    {{/useval}}
            
                    <div class="form-group  ">
                        <label for="outnumber">Номер у поставщика </label>

                        <input class="form-control" type="text" zippy="outnumber">

                    </div>
                     {{^useval}} 
                     {{^usends}} 
                    <div class="form-check">
                        <input zippy="comission" type="checkbox" class="form-check-input">
                        <label class="form-check-label" for="comission">Товары на  комиссию</label> 
                    </div>                 
                     {{/usends}} 
                     {{/useval}} 
                </div>
                <div class="col-12 col-md-3">
                   <div class="form-group  ">
                        <label for="basedoc">Основание </label>

                        <input readonly class="form-control plaintext " type="text" zippy="basedoc">

                    </div>
 
                    <div class="form-group  ">
                        <label for="notes">Примечание </label>

                        <input class="form-control" type="text" zippy="notes">

                    </div>
                     <div class="form-group">
                        <label for="scan"> Скан документа</label>
                        <input class="form-control" type="file" zippy="scan">
                    </div>                    
                </div>
            </div>
            <div class="row">
                <div class="col-12  col-xl-10">
                    {{#usescanner}}
                    <div class="navbar nav justify-content-start">
                        Штрих код &nbsp;<input autofocus="on"   style="width:150px;" autocomplete="off"  type="text" zippy="barcode"  onkeydown="onBarCode()">
                        &nbsp;   &nbsp;<a zippy="addcode" class="btn btn-info btn-sm">+</a>
                 

                    </div>
                    {{/usescanner}}

                     
                    &nbsp;<a class="btn btn-info btn-sm" zippy="addrow">Добавить позицию</a>
                    {{#usesnumberitem}}
                       &nbsp;&nbsp;  <a zippy="opensn"  >Ввод по  серийным номерам</a>
                    {{/usesnumberitem}}                    
                    <table class="table  table-sm" >
                        <tr>
                            <th></th>
                            <th>Наименование</th>
                            <th>Артикул</th>
                            <th>Штрих код</th>
                            <th>Код пост.</th>
                            <th>Ед.</th>
                            <th>{{#usesnumber}}Серия, дата{{/usesnumber}}</th>
 
                            <th class="text-right">Кол.</th>
                            <th class="text-right">Цена</th>
                            <th class="text-right">  {{#usends}} Цена с НДС {{/usends}}</th>

                            <th class="text-right">Сумма</th>

                            <th  ></th>
                        </tr>
                        <tr zippy="detail">
                            <td zippy="num"></td>
                            <td zippy="item"></td>
                            <td zippy="code"></td>
                            <td zippy="bar_code"></td>
                            <td zippy="custcode"></td>
                            <td zippy="msr"></td>
                            <td ><span zippy="snumber"></span> <span zippy="sdate" ></span> </td>
  
                            <td class="text-right" zippy="quantity"></td>

                            <td zippy="price" class="text-right"></td>
                            <td  class="text-right">
                             {{#usends}} <span zippy="pricends"></span> {{/usends}}
                            </td>

                            <td zippy="amount" class="text-right"></td>

                            <td><a zippy="edit"><i class="fa fa-edit"></i></a> &nbsp;&nbsp;&nbsp; <a zippy="delete"><i
                                        class="fa fa-trash"></i></a>
                            </td>
                        </tr>
                        <tr style="font-weight: bolder;" id="tankor">
                            <td colspan="10" class="text-right">На сумму:</td>
                            <td zippy="total" class="text-right"></td>
                            <td></td>
                        </tr>
                        {{^prepaid}}
                        
                        <tr style="font-weight: bolder;">
                            <td data-label="nds" colspan="10" class="text-right">НДС:</td>
                            <td zippy="nds" class="text-right"></td>
                            <td data-label="nds">
                             {{^usends}} 
                                 <a href="javascript:void(0);" data-toggle="modal" data-target="#modalnds"><i class="fa fa-edit"></i></a> 
                             {{/usends}}
                                        </td>
                        </tr>
                        <tr style="font-weight: bolder;">
                            <td data-label="disc" colspan="10" class="text-right">Скидка:</td>
                            <td zippy="disc" class="text-right"></td>
                            <td data-label="disc"><a href="javascript:void(0);" data-toggle="modal" data-target="#modaldisc"><i
                                        class="fa fa-edit"></i></a></td>
                        </tr>
                       {{/prepaid}}
                          <tr style="font-weight: bolder;">
                            <td data-label="delivery" colspan="10" class="text-right">Доставка:</td>
                            <td zippy="delivery" class="text-right"></td>
                            <td data-label="delivery"><a href="javascript:void(0);" data-toggle="modal" data-target="#modaldelivery"><i    class="fa fa-edit"></i></a></td>
                        </tr>

 
                        
                        <tr style="font-weight: bolder;">
                            <td data-label="payamount" colspan="10" class="text-right">Всего:</td>
                            <td zippy="payamount" class="text-right"></td>
                            <td data-label="payamount"><a href="javascript:void(0);" data-toggle="modal"
                                                          data-target="#modalpayamount"><i class="fa fa-edit"></i></a></td>
                        </tr>
                     {{#prepaid}}
                       <tr style="font-weight: bolder;">
                            <td data-label="prepaid" colspan="10" class="text-right">Предоплата:</td>
                            <td   class="text-right">  {{prepaid}}</td>
                            <td>  </td>
                        </tr>
                        {{/prepaid}}

                        <tr style="font-weight: bolder;">
                            <td data-label="payed" colspan="10" class="text-right">Внесено оплату:</td>
                            <td zippy="payed" class="text-right"></td>
                            <td data-label="payed"><a href="javascript:void(0);" data-toggle="modal"
                                                      data-target="#modalpayed"><i class="fa fa-edit"></i></a></td>
                        </tr>

                    </table>

                </div>
            </div>
         
            <div class="row">
                <div class="col-6">
                    <input type="button" value="Отменить" zippy="backtolist" class="btn btn-outline-secondary  "> 
                   &nbsp; <input zippy="savedoc" type="submit" value="Сохранить" class="btn btn-outline-primary  ">
                    &nbsp;<input zippy="execdoc" type="submit" value="Провести" class="btn btn-outline-primary  ">


                </div>
            </div>

            <div id="modalpayamount" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered  modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Всего</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="input-group  ">
                                <input class="form-control qtyprice" type="text" zippy="editpayamount" pattern="[0-9,\.]+">
                                <div class="input-group-append">
                                    <input type="submit" value="OK" zippy="bpayamount" class="ml-2 btn btn-info  ">

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div id="modalnds" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered  modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">НДС</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="input-group  ">
                                <input class="form-control qtyprice" type="text" zippy="editnds" pattern="[0-9,\.]+">
                                <div class="input-group-append">
                                    <input type="submit" value="OK" zippy="bnds" class="ml-2 btn btn-info  ">

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div id="modaldisc" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered  modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Скидка</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="input-group  ">
                                <input class="form-control qtyprice" type="text" zippy="editdisc" pattern="[0-9,\.]+">
                                <div class="input-group-append">
                                    <input type="submit" value="OK" zippy="bdisc" class="ml-2 btn btn-info  ">

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div id="modaldelivery" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered  modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Доставка</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                          <div class="form-group  ">
                                <label for="editdeliverytype"  >Тип доставки</label>
                                <select class="form-control" zippy="editdeliverytype">
                                    <option value="1">Отнести к  общим затратам</i> </option>
                                    <option value="2">Распределить на себестоимость</i> </option>
                                   <option value="3">Компенсировать поставщику</option>
                                    <option value="4">Оплата сторонней службе </option>
                                </select>
                            </div>   
                            <div class="input-group  ">
                                <input class="form-control qtyprice" type="text" zippy="editdelivery" pattern="[0-9,\.]+">
                                <div class="input-group-append">
                                    <input type="submit" value="OK" zippy="bdelivery" class="ml-2 btn btn-info  ">

                                </div>
                            </div>
                           
                                                    
                        </div>

                    </div>
                </div>
            </div>

       

            <div id="modalpayed" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered  modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Оплата</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="input-group  ">
                                <input class="form-control qtyprice" type="text" zippy="editpayed" pattern="[0-9,\.]+">
                                <div class="input-group-append">
                                    <input type="submit" value="OK" zippy="bpayed" class="ml-2 btn btn-info  ">

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </form>

        <div class="row">
            <div class="col-12 col-md-4 col-xl-3">

                <form zippy="editdetail">
                    <h4>Ввод товара </h4>


                    <div class="form-group">
                        <label for="edititem">Название </label>
                        
                        
                        <div class="input-group  ">
                        <input   placeholder="Начните  вводить..." class="form-control " zippy="edititem"/>
                              <div class="input-group-append">
                                 <a title="Добавить новый" class="btn btn-success" zippy="addnewitem" >+</a>
                            </div>                    
                         </div>
                        <a zippy="openitemsel">Открыть справочник</a>  &nbsp; &nbsp;
                        <a zippy="openlast">Последние закупки</a>

                        
                    </div>
                    {{#usesnumber}}
                    <div class="form-group">
                         {{^usesnumberitem}}
                        <label for="editsnumber">Серия (партия) производителя </label>
                         {{/usesnumberitem}}
                         {{#usesnumberitem}}
                        <label for="editsnumber">Серийный номер </label>
                         {{/usesnumberitem}}
                        
                        <input class="form-control " zippy="editsnumber"/>
                         <small>В справочнике нужно указать что данный ТМЦ учитывается  по сериям</small>
                    </div>
                    {{/usesnumber}}
                    {{#usesnumberdate}}
                    
                    <div class="form-group">
                        <label for="editsdate">Годен до </label>
                        <input class="form-control " zippy="editsdate"/>

                    </div>
                    {{/usesnumberdate}}
                      <div class="form-group  row">

                        <label class="col-6 col-form-label" for="editcustcode">Код поставщика </label>
                         <div class="col-6">
                             <input class="form-control " zippy="editcustcode"/>
                         </div>
                        <small>Например  код с  прайса</small>
                    </div>

                    <div class="form-group row">
                        <label class="col-6 col-form-label" for="editquantity">Количество</label>
                         <div class="col-6">
                            <input autocomplete="off" class="form-control qtyprice" type="text" zippy="editquantity"  required="on"                                pattern="[0-9,\.\s]+"                               style="width: 100px;"/>
                         </div>
                    </div>


                    <div class="form-group row">
                        <label class="col-6 col-form-label" for="editprice">Цена {{#usends}} (без НДС) {{/usends}} </label>
                         <div class="col-6">
                            <input autocomplete="off" class="form-control qtyprice" type="text" zippy="editprice"  required="on"                                pattern="[0-9,\.\s]+"                               style="width: 100px;">
                         </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-6 col-form-label" for="editsellprice">Отпускная цена  </label>
                         <div class="col-6">
                            <input autocomplete="off" class="form-control qtyprice" type="text" zippy="editsellprice"  pattern="[0-9,\.\%]+"   style="width: 100px;">
                         </div>
                         <small>Если задано,  корректирует   (розничную) цкну (наценку)</small>
                    </div>
                    <div class="form-group row">
                        <label class="col-6 col-form-label" data-label="editsellprice2" for="editsellprice">Отпускная цкна </label>
                         <div class="col-6">
                           <input autocomplete="off" class="form-control qtyprice" type="text" zippy="editsellprice2"  pattern="[0-9,\.\%]+"   style="width: 100px;">
                        </div>
                         <small  data-label="editsellprice2">Если зазадано корректирует (оптовую) цену (наценку)</small>
                    </div>

                    <div class="form-group">
                        <input  type="button" zippy="cancelrow" value="К списку" class="btn btn-outline-secondary  mr-2">
                        <input zippy="saverow" type="submit" value="Сохранить" class="btn btn-outline-primary"> 
                        
                    </div>


                </form>
            </div>

            <div class="col-12 col-md-8 col-xl-8">
                <div zippy="wselitem"></div>
                <div zippy="sellastitem">
                   <h5>Последние закупки</h5>
                   <small>ТМЦ за месяц (последняя партия) по  контрагенту  и типу оплат (если была  выбрана  касса)</small>
                   <table class="table  table-sm" > 
                     <tr>
                       <th >Дата</th>
                       <th >ТМЦ</th>
                       <th >Артикул</th>
                       <th >Штрих код</th>
                       <th class="text-right">Цена</th>
                     </tr> 
                     <tr zippy="sllist">
                       <td zippy="sldate"></td>                     
                       <td ><a zippy="slitem"></a></td>                     
                       <td zippy="slitem_code"></td>                     
                       <td zippy="slbar_code"></td>                     
                       <td class="text-right" zippy="slprice"></td>                     
                     </tr>                 
                   </table>
                </div>


            </div>
        </div>
        <form zippy="editnewitem">
            <h3>&nbsp;Новый товар </h3>
            <div class="row">
                <div class="col-12 col-md-4 col-xl-3">

                    <div class="form-group">
                        <label for="editnewitemname">Название </label>
                        <input autofocus="on"   class="form-control " zippy="editnewitemname"  required="on" />
                    </div>
                    <div class="form-group">
                        <label for="editnewitemcode">Код</label>
                        <input class="form-control" type="text" zippy="editnewitemcode"/>
                    </div>
                    <div class="form-group">
                        <label for="editnewitembarcode">Штрих код</label>
                        <input class="form-control" type="text" zippy="editnewitembarcode"/>
                    </div>
                    <div class="form-group  ">
                        <label for="editnewcat">Категория</label>

                        <select class="form-control" zippy="editnewcat">
                            <option value="0">Не указано</option>
                        </select>

                    </div>
                    {{#usesnumber}}
 
                     <div class="form-check">
                        <input zippy="editnewitemsnumber" type="checkbox" class="form-check-input">
                        <label class="form--label" for="editnewitemsnumber">Учитывать учет по  сериях  </label>
                    </div>                    
                    {{/usesnumber}}
     
                    <div class="form-group">
                        <label for="editnewmanufacturer">Бренд, производитель </label>
                        <input   class="form-control " zippy="editnewmanufacturer"/>

                    </div>
                 <div class="form-group">
                        <label for="editnewmsr">Ед. изм.</label>
                        <input class="form-control" type="text" zippy="editnewmsr"/>
                    </div>
                    
                    
                    <div class="form-group">
                        <input type="button" zippy="cancelnewitem" value="Отменить" class="btn btn-outline-secondary  mr-2">
                        <input zippy="savenewitem" type="submit" value="Сохранить" class="btn btn-outline-primary">
                        
                    </div>
                </div>
            </div>
        </form>
        <form zippy="editcust">
            <h3>&nbsp;Новый постаавщик </h3>
            <div class="row">
                <div class="col-12 col-md-4 col-xl-3">

                    <div class="form-group">
                        <label for="editcustname">Название </label>
                        <input autofocus="on"   class="form-control " zippy="editcustname"  required="on" />
                    </div>
                    <div class="form-group">
                        <label for="editphone">Телефон</label>
                        <input class="form-control" type="text" zippy="editphone"/>
                    </div>
                    <div class="form-group">
                        <label for="editaddress">Адреса</label>
                        <input class="form-control" type="text" zippy="editaddress"/>
                    </div>


                    <div class="form-group">
                        <input type="button" zippy="cancelcust" value="Отменить" class="btn btn-outline-secondary mr-2">
                        <input zippy="savecust" type="submit" value="Сохранить" class="btn btn-outline-primary">
                        
                    </div>
                </div>
            </div>
        </form>
       
        
        <form zippy="editsnitem">
            <h3>&nbsp;Ввод по  серийным номерам</h3>
            <div class="row">
                <div class="col-12 col-md-4 col-xl-3">

                    <div class="form-group">
                        <label for="editsnitemname">Название </label>
                        <input  autofocus="on"   placeholder="Начните  вводить..." class="form-control " zippy="editsnitemname"  required="on" />
                         <small>В справочнике нужно указать что данный ТМЦ учитывается по серийным номерам</small>
                       
                    </div>
                    <div class="form-group">
                        <label for="editsn">Серийные номера</label>
                        <textarea style="height:400px;" class="form-control" type="text" zippy="editsn"> </textarea>
                        <small>По номеру в  строке</small>
                    </div>
          
                     <div class="form-group">
                        <label for="editsnprice">Цена </label>
                        <input autocomplete="off" class="form-control qtyprice" type="text" zippy="editsnprice"  required="on"                                pattern="[0-9,\.\s]+"                               style="width: 100px;">
                    </div>
                    
                    <div class="form-group">
                        <input type="button" zippy="cancelsnitem" value="Отменить" class="btn btn-outline-secondary mr-2">
                        <input zippy="savesnitem" type="submit" value="Сохранить" class="btn btn-outline-primary">
                        
                    </div>
                </div>
            </div>
        </form>        
        
        
        {{#usescanner}}
        <script>
            $(document).ready(function () {
      
      
               $("#edititem").focus()      
    

                var val = sessionStorage.getItem('decoder_readers');
                if (val != null) {
                    $('#decoder_readers').val(val);
                }
                val = sessionStorage.getItem('stream_constraints');
                if (val != null) {
                    $('#stream_constraints').val(val);
                }

                
 
            });

            function onBarCode(ele) {

                if (event.key === 'Enter' || event.keyCode == 13) {
                    // alert($('#barcode').val());
                    $('#addcode').click()
                }
            }


       
      

        </script>
 
        {{/usescanner}}
    </body>
</html>
