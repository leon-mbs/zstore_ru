<html>
    <head>
        <link rel="stylesheet" href="/assets/css/ekko-lightbox.css">
        <script src="/assets/js/ekko-lightbox.js" type="text/javascript"></script>
            <title> Номенклатура </title>

    </head>

    <body>
        <div class="row">

            <div class="col-12  " zippy="itemtable">
                <h3>Номенклатура
                    
                </h3>

                <div class="card">

                    <form zippy="filter" class="row   g-2 align-items-center">
                      <div class="col-auto">
                        <input autocomplete="off" placeholder="Поиск..." class="form-control mr-2" type="search" zippy="searchkey" onkeydown="onSearch()">
                      </div>
                       <div class="col-auto">  
                          <div class=" row no-gutters"> 
                           <label class="col-auto mt-2"  for="searchcat">категория</label>
                              <div class="col-auto">
  
                                <select class="form-control mr-2" zippy="searchcat">
                                    <option value="0">Не указано</option>
                                </select>
                             </div>
                       </div>
                      </div>
               
                      <div class="col-auto">  
                          <div class=" row no-gutters"> 
                             <label class="col-auto mt-2"  for="searchbrand">Бренд </label>
                           <div class="col-auto">
                              <input autocomplete="off"   class="form-control mr-2" zippy="searchbrand"/>
                           </div>
                         </div>
                      </div>
                       <div class="col-auto">  
                          <div class=" row no-gutters"> 
                              <label class="col-auto mt-2"  for="searchtype">Тип</label>
                          <div class="col-auto">
                            <select zippy="searchtype" class="form-control mr-sm-2">
                                <option value="0">Все </option>
                                <option value="1">Товары</option>
                                <option value="2">Материалы и комплектующие</option>
                                <option value="3">МБП</option>
                                <option value="4">Готовая продукция</option>
                                <option value="5">Полуфабрикаты</option>
                                <option value="9">Весовые</option>
                                <option value="10">Деактивированные</option>
                            </select>
                          </div>
                       </div>
                      </div>

              
                      <div class="col-auto">  
                          <div class=" row no-gutters"> 
                            <label class="col-auto mt-2"  for="searchsort">Сортировка</label>

                         <div class="col-auto">
                            <select class="form-control mr-2" zippy="searchsort">
                                <option value="0">Наименование</option>
                                <option value="1">Артикул</option>
                                <option value="2">Тип</option>
                                <option value="3">Сначала  новые</option>
                            </select>
                          </div>
                       </div>
                      </div>
                       
                          <div class="col-auto">  
         
                               <input class="btn btn-outline-success  " type="submit" value="ОК">
                           </div>
                    </form>
                   
                    
                </div>
               
                    
                 <details class="mb-2 ml-2">
                    <summary >Тэги</summary>
                    <small zippy="taglist"></small>
                 </details>
                   
                 <div class="row mb-2"  >
                 <div class="col-2   "  >
                                
                <a zippy="addnew" class="btn btn-primary mr-4  "> <i class="fa fa-plus-circle"></i> Добавить новый</a>
                 </div>  
                <div class="col-1   "  >
                                
                <a   href="/index.php?p=App/Pages/Service/Import"> <i class="fa fa-download"></i> Импорт</a>
                 </div>  
                 <div class="col-2  "  >
                 
                   <a     zippy="options"  ><i class="fa fa-cog"> </i> Настройки</a>
                
                </div>               
                </div>               
                <form zippy="listform">
                    <table class="table table-hover  table-sm  ">
                        <tr>
                            <th style="width:20px"><i onclick=" $('.seldel').prop('checked', $('.seldel').prop('checked') == false);"
                                style="cursor:pointer" title="Снять/выставить флаг"
                                    class="fa fa-check-double "></i></th>                    
                            {{#useimages}}
                            <th></th>
                            {{/useimages}}
                            <th>Наименование</th>

                            <th>Артикул</th>
                            <th>Категория</th>
                            <th>Бренд</th>
                            {{#usecf}}
                            <th>Каст. поля</th>
                             {{/usecf}}
                            <th>Ед.</th>
                              <th> </th>
                            {{#hp1}}<th class="text-right  ">{{hp1}}</th>{{/hp1}}
                            {{#hp2}}<th class="text-right  ">{{hp2}}</th>{{/hp2}}
                            {{#hp3}}<th class="text-right  ">{{hp3}}</th>{{/hp3}}
                            {{#hp4}}<th class="text-right  ">{{hp4}}</th>{{/hp4}}
                            {{#hp5}}<th class="text-right  ">{{hp5}}</th>{{/hp5}}

                            <th> <i title="В наличии" class="fa fa-store"></i> </th>
                            <th> <i title="Ячейка" class="fa fa-box"></i> </th>
                            <th><i title="В прайсе" class="fa fa-list-alt"></i></th>
                            {{#usesnumber}}
                            <th><i title="Учет серий производителя" class="fa fa-calendar-check"></i></th>
                            {{/usesnumber}}
                            <th></th>
                            <th></th>
                            <th></th>
                       
                            <th></th>


                            <th  ></th>
                        </tr>
                        <tr zippy="itemlist">
                            <td><input  zippy="seldel" class="seldel" type="checkbox"></td>
                            {{#useimages}}
                            <td>
                                <a zippy="imagelistitem" data-type="image" data-toggle="lightbox"  > <img
                                        style="float:left; width:64px"></a>

                            </td>
                            {{/useimages}}

                            <td ><a zippy="itemname"></a></td>

                            <td class="text-nowrap"  zippy="code"></td>
                            <td zippy="cat_name"></td>
                            <td zippy="manufacturer"></td>
                                 {{#usecf}}
                            <td zippy="cfval"> </td>
                             {{/usecf}}  
                            <td zippy="msr"></td>
                            <td   ><i    zippy="hasaction" class="fa fa-gift"></i></td>

                            {{#hp1}}<td zippy="price1" class="text-right  "></td>{{/hp1}}
                            {{#hp2}}<td zippy="price2" class="text-right  "></td>{{/hp2}}
                            {{#hp3}}<td zippy="price3" class="text-right  "></td>{{/hp3}}
                            {{#hp4}}<td zippy="price4" class="text-right  "></td>{{/hp4}}
                            {{#hp5}}<td zippy="price5" class="text-right  "></td>{{/hp5}}

                            <td ><i zippy="onstore" class="fa fa-check"></i></td>
                            <td zippy="cell"></td>
                            <td><i zippy="inprice" class="fa fa-check"></i></td>
                            {{#usesnumber}}
                            <td><i zippy="inseria" class="fa fa-check"></i></td>
                            {{/usesnumber}}
                            <td><a zippy="shownotes"><i zippy="hasnotes" class="far fa-sticky-note"></i></a> </td>

                            <td><a zippy="set" title="Комплекты"><i class="fa fa-cogs"></i></a> &nbsp;</td>
                            <td  >
                                <a zippy="printqr" title="Печать QR кода"><i class="fa fa-qrcode"></i></a>
                            </td>
                             <td  >
                                <a zippy="printst" title="Стикер для расфасованого"><i class="fa fa-balance-scale"></i></a>
                            </td>
                           
                            <td aling="center">
                                <a zippy="copy" title="Копировать"><i class="fa fa-copy"></i></a> &nbsp;&nbsp;&nbsp;
  
                                <a zippy="edit" title="Редактировать"><i class="fa fa-edit"></i></a> &nbsp;
                                
                            </td>
                        </tr>
                        <tr><td colspan="9">
                                <a class="text-danger" zippy="deleteall" title="Удалить (деактивировать)"><i class="fa fa-trash"></i></a>&nbsp;&nbsp;
                                <a  zippy="printall" title="Друк етикеток"><i class="fa fa-print"></i></a>&nbsp;&nbsp;  
                                <a zippy="priceall">Сменить цены</a>&nbsp;&nbsp;
                                Перемiстити в <select   zippy="allcat"><option value="0">Не указано </option></select>
                            </td> </tr>                 
                    </table>
                    <div class="w-50" zippy="pag"></div>   
                </form>
            </div>


            <div class="col-12  ">
                <form zippy="itemdetail" enctype="multipart/form-data">
                    <h4>Редактирование   </h4>
                    <div class="row">
                        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editname">Наименование</label>
                                <div class="col-7">
                                    <input required="on" autofocus="on"   class="form-control" zippy="editname"/>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editshortname">Сокращенное  название  
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Например для  ценников.  Длина задается  в  настройках"></i>
                                </label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editshortname"/>
                                 </div>    
                                
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcat">Категория</label>
                                <div class="col-7">
                                    <select class="form-control" zippy="editcat">
                                        <option value="0">Не указано</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editprice1">Цены (наценки, %)
                                 <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Типы цен задаются в настройках. Для наценок указать '%' 
                                   после цифры, например, 20%. Наценка рассчитывается от учетной цены"></i>
                                </label>
                                <div class="col-7">
                                    <input style="width: 150px" pattern="[0-9,\.\%]+" class="form-control" zippy="editprice1"/>
                                    <input style="width: 150px" pattern="[0-9,\.\%]+" class="form-control" zippy="editprice2"/>
                                    <input style="width: 150px" pattern="[0-9,\.\%]+" class="form-control" zippy="editprice3"/>
                                    <input style="width: 150px" pattern="[0-9,\.\%]+" class="form-control" zippy="editprice4"/>
                                    <input style="width: 150px" pattern="[0-9,\.\%]+" class="form-control" zippy="editprice5"/>
                                   
                                </div>
                            </div>                                 


                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcode">Код товара (артикул)
                                 <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Код должен быть уникальным.
                                       Если используется  код производителя, мледует добавить код к бренду, например, k123_названиебренда"></i>
                                </label>                                
                                <div class="col-5">
                                    <input class="form-control" zippy="editcode"/>
                                  

                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editbarcode">Штрих код (основной)</label>
                                <div class="col-5">
                                    <input class="form-control" zippy="editbarcode"/>
                                    <small   >Латинские буквы и цифры</small>
                                </div>
                            </div>
                           <div class="form-group row">
                                <label class="col-5 col-form-label" for="editbarcode1">Штрих код (дополнительный)</label>
                                <div class="col-5">
                                    <input class="form-control" zippy="editbarcode1"/>
                                    
                                </div>
                            </div>
                      <div class="form-group row">
                                <label class="col-5 col-form-label" for="editbarcode2">Штрих код (додатковий)</label>
                                <div class="col-5">
                                    <input class="form-control" zippy="editbarcode2"/>
                                    
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcode">Тип ТМЦ</label>
                                <div class="col-5">
                                    <select class="form-control" zippy="edittype">
                                        <option value="0">Не указано</option>
                                    </select>

                                </div>
                            </div>

                       


                           <div class="form-group row">
                                <label class="col-5 col-form-label" for="editmsr">Ед. измерения</label>
                                <div class="col-3">
                                    <input class="form-control" zippy="editmsr"/>
                                </div>
                            </div>       
                           

                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcostprice">Себестоисость (Учетная цена)
                                   <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Используется по умолчанию при оприходовании. Для производства имеет приоритет перед комплектами"></i>
                                </label>  
                                <div class="col-7">
                                    <input pattern="[0-9,\.]+" style="width: 100px;" class="form-control qtyprice" zippy="editcostprice"/>
                                    
                                </div>
                            </div>
                         {{#usends}}      
                            
                        <div class="form-group row">
                            <label class="col-5 col-form-label" for="editisnds">Использование НДС</label>
                            <div class="col-5">
                                <select class="form-control" zippy="editisnds">
                                    <option value="0">По категории</option>
                                    <option value="1">Без НДС</option>
                                    <option value="2">Как указано</option>
                                </select>
                            </div>
                        </div>
                         <div class="form-group row">
                            <label  class="col-5 col-form-label" for="editnds">Ставка НДС,%</label>
                             <div class="col-4">
                               <input style="width:75px"  pattern="[0-9,\.]+" class="form-control qtyprice" zippy="editnds"/>
                            </div>  
                        </div> 
                         {{/usends}}     
                              {{#useprod}}   
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editzarp">Сумма оплаты 
                                   <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Начисление при  сдельной оплате"></i>
                                </label>  
                                <div class="col-7">
                                    <input pattern="[0-9,\.]+" style="width: 100px;" class="form-control qtyprice" zippy="editzarp"/>
                                    
                                </div>
                            </div>
                            {{/useprod}}  
                            {{#usesnumber}}
                            <div class="form-check">
                                <input zippy="edituseserial" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="edituseserial">Учет серий производителя или  серийных номеров</label>
                            </div>


                            {{/usesnumber}}
                            <div class="form-check">
                                <input zippy="editnoprice" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editnoprice">Не показывать в прайсе</label>
                            </div>
                            <div class="form-check">
                                <input zippy="editnoshop" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editnoshop">Не показывать в онлайн торговле   </label>
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Не показувати в онлайн каталозi, меню кафе та  IM  "></i>                                
                            </div>
                            <div class="form-check">
                                <input zippy="editautooutcome" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editautooutcome">Автоматическое  списание  комплекта</label> 
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Списание составных частей в создание при оприходовании готовой продукции. 
                                    Подходит для короткого цикла производства, например, в общепите. Списывает только первый уровень - 
                                    комплект в комплекте следует списывать вручную"></i>

                            </div>
                            <div class="form-check">
                                <input zippy="editautoincome" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editautoincome">Автоматически оприходовать при  продаже</label>
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Оприходование готовой продукции на склад перед продажей (списанием со склада). 
                                     Подходит для внеказного производства без необходимости оприходовать отдельным документом"></i>


                            </div>

                            <div class="form-check">
                                <input zippy="editisweight" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editisweight">Весовой товар</label>
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Для печати стикеров на предварительно расфасованный товар. Присканирование гтрихкода в АРМ кассира 
                                    товар будет добавлен с указанной ценой и весом"></i>
                            </div>
                             <div class="form-check">
                                <input zippy="editdisabled" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="editdisabled">Больше не  используется</label>
                            </div>


                        </div>
                        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                                 <div class="form-group row">
                                <label class="col-5 col-form-label" for="editminqty">Мін. кількість
                                  <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Если задано, то при уменьшении количества на складе меньше указанного, 
                                    товар появится в соответствующем виджете на главной странице"></i>
                                </label>                                 
                                <div class="col-7">
                                    <input pattern="[0-9,\.]+" style="width: 100px;" class="form-control qtyprice" zippy="editminqty"/>
                                   
                                </div>
                            </div>
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editmanufacturer">Бренд, производитель   </label>
                                <div class="col-7">
                                    <input list="manlist" class="form-control" zippy="editmanufacturer"/>
                                    <datalist id="manlist">
                                        {{#manlist}}
                                        <option label="{{mitem}}" value="{{mitem}}"></option>
                                            {{/manlist}}

                                    </datalist>
                                </div>
                            </div>                        
                        
                        
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcountry">Страна-производитель</label>
                                <div class="col-7">
                                    <input autocomplete="on" class="form-control" zippy="editcountry"/>
                                </div>
                            </div>
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editwarranty">Гарантийный срок</label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editwarranty"/>
                                </div>
                            </div> 
                         
                      
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcell">Ячейка на  складе</label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editcell"/>
                                </div>
                            </div>    
                            {{#hideblock}}            
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editweight">Вес </label>
                                <div class="col-7">
                                    <input class="form-control qtyprice" zippy="editweight" pattern="[0-9,\.]+"/>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editmaxsize">Макс. габарит, см</label>
                                <div class="col-7">
                                    <input class="form-control qtyprice" zippy="editmaxsize" pattern="[0-9,\.]+"/>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editvolume">Обьем </label>
                                <div class="col-7">
                                    <input class="form-control qtyprice" zippy="editvolume" pattern="[0-9,\.]+"/>
                                </div>
                            </div>
                             {{/hideblock}}
                        
                         
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editcustomsize">Параметр для покупателя (обьем, вес)</label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editcustomsize"   />
                                    <small> Для каталога или  меню общепита (300 г, 250 мл...)</small>
                                </div>
                            </div>   
                                              
                         
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editlost">Отходы, % 
                                  <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Потери при автоматическом списании в производство при оприходовании комплектов. Например очистки 
из картофеля в общественном питании"></i>
                                </label>                                 
                                <div class="col-7">
                                    <input pattern="[0-9,\.]+"  class="form-control qtyprice" zippy="editlost"   />
                                   
                                </div>
                            </div>   
                            {{#useimages}}
                            <div class="form-group row">
                                <label class="col-5 col-form-label">Изображение
                               <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Изображение должно быть квадратным (иначе будет обрезано) и с размером файла не более 1M"></i>
                                </label>   

                                <div class="col-7">
                                    <img zippy="editimage" style="height:128px"><br>
                                    <input  accept="image/png,image/jpeg" type="file" class="form-control" zippy="editaddfile">
                                    <div class="form-check">
                                        <input  zippy="editdelimage" type="checkbox" class="form-check-input">
                                        <label class="form-check-label" data-label="editdelimage" for="editdelimage">Удалить                                            зображення</label>
                                    </div>
                                   

                                </div>
                            </div>
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editimageurl"> URL изображения
                                 <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Ссылка, например, на внешнее изображение. Если каталог локальный можно указать относительную 
                                              адрес. При прямой ссылке не проверяется право доступа"></i>
                                                               </label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editimageurl"   />
                                    <small>Приоритет  имеет загруженное (выше) изображение</small>
                                </div>
                            </div>  
                            {{/useimages}}
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editurl">URL для QR кода
                                 <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="Ссылка на  товар  в  ИМ или сайте производителя"></i>
                                </label>                                   
                                <div class="col-7">
                                    <input class="form-control" zippy="editurl"/>
                                     
                                </div>
                                                          
                            </div>
                             <div class="form-group row">
                                <label class="col-5 col-form-label" for="editprintqty">Печать этикеток</label>
                                <div class="col-7">
                                    <select class="form-control" zippy="editprintqty">

                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">По количеству  на  складе (или  в  документе) </option>
                                        <option value="4">За крл. на складе но не  больше 10</option>
                                        <option value="5">Не печатать</option>                  
                                    </select>
                                      <small>Для весового товара  всегда 1</small>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editnotes">Примечание</label>
                                <div class="col-7">
                                    <input class="form-control" zippy="editnotes"/>
                                    <small>Например для прайса</small>
                                </div>
                                
                            </div>                            
                            <div class="form-group row">
                                <label class="col-5 col-form-label" for="editdescription">Описание</label>
                                <div class="col-7">
                                    <textarea style="height:100px" class="form-control" zippy="editdescription"></textarea>
                                </div>
                            </div>    
                           <div class="form-group row">
                               <label class="col-5 col-form-label" for="edittags">Тэги</label>
                                <div class="col-7">
                                 <div zippy="edittags"> </div>
                                  <small>Вводятся по  Enter</small>
                               </div>
                          </div>                                
                        </div>
                        {{#cflist}}
                       <div class="col-12 col-md-8 col-lg-4 col-xl-2">
                     
                        <div class="form-group  " zippy="cflistv">
                                <label zippy="cfd"  >   </label>
                              
                                    <input zippy="cfval" class="form-control"  />

                               
                            </div> 
                          
                       </div>
                        {{/cflist}}
                       
                        <div class="col-8 mt-4   ">

                           
                                <input zippy="cancel" type="button" value="Отменить" class="btn btn-secondary mr-4 "> 
                                <input zippy="save" type="submit" value="Сохранить" class="btn btn-primary  ">
                                
                           
                        </div>
                    </div>
                </form>

            </div>

          <div class="col-12 col-md-6 col-xl-4 ">
                <form zippy="changeall"  >
                             <table>
                             <tr zippy="itemcalist">
                             <td zippy="editallname">
                              <td>
                             <td>
                               <input style="width: 130px" pattern="[0-9,\.\%]+" class="form-control" zippy="editallprice"/>
                                      
                              <td>
                              </tr>
                             </table>             
                            <div class="form-group">
                                <input zippy="cancelca" type="button" value="Отменить" class="btn btn-outline-secondary mr-2 "> 
                                <input zippy="saveca" type="submit" value="Сохранить" class="btn btn-primary  ">
                                
                            </div>
                                 
                </form>   
          </div>       
            
        </div>

        <div class="row">

            <div class="col-12 col-md-8 col-xl-6" zippy="setpanel">
                <a zippy="backtolist"><i class="fa fa-arrow-alt-circle-left"></i> К справочнику</a>
                <h4 zippy="stitle"></h4>
               
                {{#complin}}
                <span>Комплектв (рецепты) для готовой продукции и полуфабрикаитов</span>
                <form zippy="setform" class="form-inline mt-2 mb-2">
                    <label for="editsname">ТМЦ</label>
                    <input placeholder="Начните вводить.." class="form-control  mr-sm-2" zippy="editsname"/>

                    <label for="editsqty">Кол.</label>
                    <input autocomplete="off" class="form-control  qtyprice  mr-sm-2" type="text" zippy="editsqty"  required="on" 
                           pattern="[0-9,\.]+" style="width:60px">
                    <input zippy="setformbtn" class="btn btn-outline-success  " type="submit" value="Добавить">
                </form>
                <table class="table   table-sm  ">
                    <tr>
                        <th>Наименование</th>
                        <th>Код</th>
                        <th class="text-right">Кол.</th>
                        <th></th>
                    </tr>
                    <tr zippy="setlist">
                        <td zippy="sname"></td>
                        <td zippy="scode"></td>
                        <td class="text-right" zippy="sqty"></td>
                        <td><a zippy="sdel"><i class="fa fa-trash"></i></a></td>
                    </tr>
                </table>
           
                 <form zippy="setsform" class="form-inline mt-2 mb-2">
                    <label for="editssname">Работа, услуга</label>
                    <select class="form-control  select2" zippy="editssname">
                      <option value="0">Не выбрано</option>
                    </select>

                    <label class="ml-sm-2" for="editscost">Стоимость</label>
                    <input autocomplete="off" class="form-control  qtyprice  mr-sm-2" type="text" zippy="editscost"  required="on" 
                           pattern="[0-9,\.]+" style="width:60px">
                           
                    <input zippy="setsformbtn" class="btn btn-outline-success  " type="submit" value="Добавить">
                </form>
                 <table class="table   table-sm  ">
                    <tr>
                        <th>Наименование</th>
                        
                        <th class="text-right">Стоимость</th>
                        <th></th>
                    </tr>
                    <tr zippy="ssetlist">
                        <td zippy="ssname"></td>
                        
                        <td class="text-right" zippy="sscost"></td>
                        <td><a zippy="ssdel"><i class="fa fa-trash"></i></a></td>
                    </tr>
                </table>
                <span>Всего сеьестоимость: </span> <b zippy="stotal"></b>
                 <br>
                 <br>
                 <h5>Тех. карта</h5>
                  <small>Например рецепт для  кухни</small>
                 <form zippy="cardform" >
                    <textarea style="height:200px" class="form-control" zippy="editscard"></textarea> 
                           
                
                    <input class="btn btn-outline-success  " type="submit" value="Сохранить">
                 </form>
               {{/complin}}  
               {{#complout}}  
               <span>Является составляющим  комплекта для: </span>
                 <table class="ctanle">
                  {{#conploutlist}}
                   <tr><td>{{iname}}</td><td>{{icode}}</td><td align="right">{{iqty}}</td></tr>
                    {{/conploutlist}}
                 </table>
                 
               {{/complout}}  
               
               
            </div>
        </div>

      <div class="col-12  col-md-8 col-xl-6 ">
                <form zippy="optionsform"  >
                 <h4>Настройка справочника   </h4>
                             <div class="form-check">
                                <input zippy="useimages" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="useimages">Изображение в  номенклатуре </label>
                             
                            </div> 
                             <div class="form-check">
                                <input zippy="usecattree" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="usecattree">Иерархия категорий ТМЦ </label>
                     
                            </div>                                                       
                             <div class="form-check">
                                <input zippy="nocheckarticle" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="nocheckarticle">Не уникальность артикулов</label>
                             
                            </div> 
                             <div class="form-check">
                                <input zippy="allowchange" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="allowchange">Разрешить изменять уже используемый  артикул</label>
                            
                            </div> 
                             <div class="form-check ">
                                <input zippy="autoarticle" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="autoarticle"> Автоматически  генерировать       артикул</label>
                                < 
                            </div> 
                            {{#usebranch}}
                             <div class="form-check ">
                                <input zippy="branchprice" type="checkbox" class="form-check-input">
                                <label class="form-check-label" for="branchprice"> Привязка  цен  к  филиалам
                                <i class="fa fa-info-circle  " data-toggle="tooltip" data-placement="top"
                                   title="При сохранении  ТМЦ отпускные  цены будут привязаны отдельно для текущего (выбранного  вверху страницы) филиала"></i>
                            </div> 
                               {{/usebranch}}
                             <div class="form-group row mt-2">
                                <label class="col-3 col-form-label" for="articleprefix">Префикс в артикулах</label>
                                <div class="col-2">
                                    <input pattern="[a-zA-Z]+"    class="form-control" zippy="articleprefix"/>
                                </div>
                            </div> 
                                                                                
                   <h5 class="mt-2">Кастомные поля   </h5>
                   <small> Поля создаваемые пользователем. В основном для поиска  и печати  в  ценниках   </small>
                   <br><small>   Код колжен быть уникальным допускается латиница и цифри     </small>
                   <br><a  zippy="addnewcf"><b>Добавить</b></a>

                       <table class="ctable mt-2">
                        <tr zippy="cflist">
                            <td>Код </td>
                            <td> <input pattern="[a-zA-Z0-9]+"   required="on" class="form-control" style="width:100px;" zippy="cfcode"  ></td>
                            <td>Название </td>
                            <td><input required="on" class="form-control" style="width:250px;" zippy="cfname"  > </td>
                            <td><a zippy="delcf"> <i class="fa fa-trash"></i></a></td>
                         </tr>    
                      </table>                       
                        <div class="form-group mt-2">
                                <input zippy="cancelc" type="button" value="Отменить" class="btn btn-outline-secondary mr-2 "> 
                                <input zippy="savec" type="submit" value="Сохранить" class="btn btn-primary  ">
                                
                      </div>         
                </form>   
     </div>             
        
 

        
     <div id="pscale" class="modal fade   " tabindex="-1" role="dialog"  aria-hidden="true">
            <div class="modal-dialog modal-sm ">
                <div class="modal-content">
                    <div class="modal-body">
                    <h4>Печать стикера</h4>
                    <form id="formsticker">
                     <input type="hidden" name="stitemid" id="stitemid">   
                     <div class="form-group row">
                      <label class="col-5 col-form-label" for="stqty">Вес</label>
                      <div class="col-5">
                            <input id="stqty" name="stqty" class="form-control"  >
                         </div>
                         {{#usescale}}
                          <div class="col-2">
                             <a title="Поучить с электронных весов"  href="#" id="onscale" class="btn btn-success"><i class="fa fa-scale-balanced"></i></a>
                         </div>
                         {{/usescale}}
                     </div>
                    <div class="form-group row">
                      <label class="col-5 col-form-label" for="stprice">Цена</label>
                      <div class="col-5">
                        <input id="stprice" name="stprice" class="form-control"   >
                     </div>
                     </div>
                    <div class="form-group row">
                      <label class="col-5 col-form-label" for="stsum">Сумма</label>
                      <div class="col-7">
                       <b id="stsum">  </b>
                     </div>
                     </div>
                      
                     
                      <div class="form-group  ">
                        <input onclick="getSticker()" type="button" class="btn btn-success" value="Печатать"> 
                     </div>
                     
                    </form>
                   
                  
                        <div   id="tagsticker"></div>
                    </div>
                </div>
            </div>
        </div>
        
 <div id="pform" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
             aria-hidden="true">
            <div class="modal-dialog  ">
                <div class="modal-content">
                    <div class="modal-body">
                        <table>
                            <tr>
                                <td align="center" id="tag"></td>
                            </tr>
                            <tr>
                                <td align="center"><a href="javascript:void(0)"
                                                      onclick="$('#tag').printThis();$('#pform').modal('hide')"
                                                      class="btn btn-success  ">Печать</a></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>            
        
        <div id="idesc" class="modal fade  " tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
             aria-hidden="true">
            <div class="modal-dialog  ">
                <div  class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title">Описание</h5>
                   
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div id="idesccontent" class="modal-body">
                        

                    </div>       
                </div>
            </div>
        </div>
    
        <script>
            $(document).ready(function () {

    
                $(document).on('click', '[data-toggle="lightbox"]', function (event) {
                    event.preventDefault();
                    $(this).ekkoLightbox({'alwaysShowClose': true});
                });

                //данные с электронныъ весов
                $("#onscale").click(function(event) {
                   event.preventDefault();
               
               
                    callScale( (weight)=>
                    {
                        $("#stqty").val(weight); 
                    })
                      
                        
                }); 

                
                $("#stqty").on('input',function () {
                    stsum()

                });                
                $("#stprice").on('input',function () {
                    stsum()

                });                
                

            });

            function onSearch(ele) {

                if (event.key === 'Enter' || event.keyCode == 13) {
                    // alert($('#barcode').val());
                    $('#filter').Submit();
                }
            }

            function check_deleteall() {
                return confirm("Удалить ТМЦ?")
            }
        
            
         function getSticker( ){
              
                   
                callPMForm('getSticker',null,'formsticker',(data)=> 
                {
                     
                 
                     
                    if(data.printer == 0) {
                       $('#tagsticker').html(data.data);
                       $('#tagsticker').printThis();
                    }
                    if(data.printer > 0) {
                       console.log(data.data)   
                       sendPSlabel(  JSON.stringify(data.data) )  
                    }
                    $('#pscale').modal('hide') 
         
                } )
            }            
         
         function stsum(){
           
            var price = $("#stprice").val()??0;  
            var qty = $("#stqty").val() ??0;  
   
            var sum = parseFloat(price) * parseFloat(qty)   ;
   
   
            if (sum > 0) {
                $("#stsum").text( fa(sum)  )
            } else {
                $("#stsum").text('') 
            }        
         }   
       function check_delcf() {

            return confirm("Удалить?")

        }   
        
        function check_saveca() {

            document.getElementById('dialogwait').showModal()
          
            return true;
               

        }   
        
            
        </script>

    
    </body>
</html>
